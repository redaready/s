!function(){function t(){for(var t={},e=0;e<arguments.length;e+=1)for(var n=arguments[e],o=Object.keys(n),i=0;i<o.length;i+=1)t[o[i]]=n[o[i]];return t}function e(t,e,n){t.addEventListener?t.addEventListener(e,n,!1):t.attachEvent&&t.attachEvent("on"+e,n)}function n(t){for(var e in t)void 0===t[e]&&delete t[e];return t}function o(t,e,n){var i,r,a,c;if(c=/\[\]$/,e instanceof Array)for(r=0,a=e.length;a>r;r++)c.test(t)?n(t,e[r]):o(t+"["+("object"==typeof e[r]?r:"")+"]",e[r],n);else if("object"==typeof e)for(i in e)o(t+"["+i+"]",e[i],n);else n(t,e)}function i(t,e,o,i){function r(){return l.readyState<4?void 0:200!==l.status?void("function"==typeof i&&i(l,!1)):void(4===l.readyState&&"function"==typeof i&&i(l,!0))}e=n(e);var a=_(e),c=t+"?"+a;o=o||(c.length>2083?"POST":"GET");var s="GET"===o?c:t;e="POST"===o?JSON.stringify(e):null;var l=new XMLHttpRequest;if("withCredentials"in l)l.open(o,s,!0);else{if("undefined"==typeof XDomainRequest)return;l=new XDomainRequest;var u=function(){},f=function(){"function"==typeof i&&i(l,!0)};l.onerror=u,l.ontimeout=u,l.onprogress=u,l.onload=f,l.timeout=5e3,l.open(o,s)}l.onreadystatechange=r,l.send(e)}function r(){var t={},e=function(t){return decodeURIComponent(t.replace(/\+/g," "))},n=location.search.substring(1),o=location.hash.substring(1),i=n.split("&");i=i.concat(o.split("&"));for(var r in i)if(i.hasOwnProperty(r)){var a=i[r].toString().split("=");a.length>1&&(t[e(a[0])]=e(a[1]))}return t}function a(){return C}function c(){a()&&(g[y].Click.flushQueue(),g[y].Conversion.flushQueue())}function s(t){g[y].vid=t.sort()[0],g[y].vids=t,C=!0}function l(){if(g[y].vids){for(var t=[],e=g[y].vids.length-1;e>=0;e--){var n=g[y].vids[e];n&&-1===t.indexOf(n)&&t.push(n)}if(t.length)return t}}function u(){function t(){for(var t=o.length-1;t>=0;t--)a.read.apply(a,o[t]);for(var e=i.length-1;e>=0;e--)a.write.apply(a,i[e])}var e={},n=0,o=[],i=[],r=!1,a=this;return this.addMethod=function(t){return t.supported()?(n++,e[t.key]=t,this):void 0},this.init=function(){function o(){i--,0>=i&&(r=!0,t())}var i=n;for(var a in e)"function"==typeof e[a].init?e[a].init(o):o()},this.read=function(t,i,a){function c(t,e,n){clearTimeout(u[n]),e&&e.constructor===Array?l=l.concat(e):l.push(e),s--,0===s&&a(null,l)}if(!r)return void o.push(arguments);var s=n,l=[],u={};for(var f in e){u[f]=setTimeout(c,2e3);try{e[f].read(t,c)}catch(p){}}},this.write=function(t,o,a,c){function s(){l--,0===l&&"function"==typeof c&&c()}r||i.push(arguments);var l=n;for(var u in e)e[u].write(t,o,a,s)},this.hasMethod=function(t){return"undefined"!=typeof e[t]},this}function f(t,e){return this.key=t,this.options=e||{},this.setOption=function(t,e){this.options[t]=e},this}function p(){return this.constructor.apply(this,arguments),this.callbacks={},this}function d(t){g[y].Storage.hasMethod("1pcookie")||g[y].Storage.addMethod(q),g[y].Storage.hasMethod("localStorage")||g[y].Storage.addMethod(M),t.include_methods&&t.include_methods.indexOf("3p")>-1&&!g[y].Storage.hasMethod("3pCookie")&&g[y].Storage.addMethod(new p("3pCookie",{url:m,beaconVersion:b})),g[y].Storage.init()}function v(t,e){return t||0===t?t:(e=e||"ref",r()[e])}function h(t,e,n){return"function"==typeof n?1==e.always_callback?n(t):e.alwaysFireCb===!0?n(null,"error",t):void 0:void 0}var g=window,y=window.TapfiliateObject||"tap",k=g[y]?g[y].q||[]:[];if(!g[y]||!g[y].loaded){g[y]=function(t,e,n,o,i,r){var a=g[y][t];if("function"!=typeof a)throw'Function "'+t+'" not supported';a(e,n,o,i,r)},g[y].loaded=!0,g[y].baseUrl="//frstre.com",g[y].baseUrlDepr="https://tapfiliate.com";var m="https://b.frstre.com",b="v1.4";g[y].Tracking=g[y].Tracking||{},g[y].options=g[y].options||{};var C,w,S={};String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")};var _=function(t){var e,n,i,r,a,c;if(n=[],a=/%20/g,i=function(t,e){e="function"==typeof e?e():null===e?"":e,n[n.length]=encodeURIComponent(t)+"="+encodeURIComponent(e)},t instanceof Array)for(r in t)i(r,t[r]);else for(e in t)o(e,t[e],i);return c=n.join("&").replace(a,"+")};g[y].Storage=g[y].Storage||new u,f.prototype.supported=function(){return!0};var q=new f("1pCookie");q.read=function(t,e){for(var n=t+"=",o=document.cookie.split(";"),i=[],r=0;r<o.length;r++){var a=o[r].trim();0===a.indexOf(n)&&i.push(a.substring(n.length,a.length))}e(null,i,this.key)},q.write=function(t,e,n,o){var i=new Date;i.setTime(i.getTime()+31536e6);var r,a="expires="+i.toGMTString();try{var c=window.location.href,s=c.match(/(?:https?:\/\/)?(?:www\.)?(.*?)\//);r="."+s[s.length-1]}catch(l){}var u=t+"="+e+"; "+a+"; path=/";u+="undefined"!=typeof r?"; domain="+r:"",document.cookie=u,o()};var M=new f("localStorage");M.supported=function(){return"undefined"!=typeof localStorage},M.read=function(t,e){e(null,localStorage.getItem(t),this.key)},M.write=function(t,e,n,o){o(null,localStorage.setItem(t,e))},p.prototype=new f,p.prototype.supported=function(){return"undefined"!=typeof postMessage},p.prototype.handleEvent=function(t){if(t.origin===this.options.url){var e;try{e=JSON.parse(t.data)}catch(n){}e&&e.callback&&this.callbacks[e.callback](e.value)}},p.prototype.init=function(t){function n(){document.body.appendChild(o)}var o=document.createElement("IFRAME");o.setAttribute("src",this.options.url+"/?"+this.options.beaconVersion),o.style.width="1px",o.style.height="1px",o.style.display="none",e(window,"message",this);var i=this;e(o,"load",function(){i.beacon=o.contentWindow,t()}),setTimeout(n,0)},p.prototype.post=function(t){this.beacon.postMessage(t,this.options.url)},p.prototype.read=function(t,e){var n=this;this.callbacks.get=function(t){e(null,t,n.key)};var o={action:"getAll",key:t};this.post(JSON.stringify(o))},p.prototype.write=function(t,e,n,o){this.callbacks.set=function(t){o(null,t)};var i={action:"set",key:t,value:e};this.post(JSON.stringify(i))},g[y].Click=g[y].Click||{},g[y].Click.q=g[y].Click.q||[],g[y].Click.track=function(t,e,n,o){n=n||{};var i,a,s;if((null!==n.referral_code_param||void 0!==n.referral_code)&&(i=n.referral_code,a=n.referral_code_param,s=v(i,a)),!(t&&e||s))return h("No tracking parameters",n,o);var l=r(),u=null;for(var f in l)"tm_"===f.slice(0,3)&&(u=u||{},u[f.slice(3,f.length)]=l[f]);var p={data:{acc:w,aid:t,sid:e,callback:o,options:n,pm:u,ref:document.referrer||null,cup:document.location.href||null}};s&&(p.data.refc=s),g[y].Click.q.push(p),c()},g[y].Click.flushQueue=function(){g[y].Click.q.reverse();for(var t=g[y].Click.q.length-1;t>=0;t--){var e=g[y].Click.q[t].data,n=l();if(e.aid&&e.sid||e.refc){var o={acc:e.acc,aid:e.aid,sid:e.sid,pm:e.pm,ref:e.ref,cup:e.cup,refc:e.refc};n&&g[y].Storage.hasMethod("3pCookie")&&(o.vids=n),i(g[y].baseUrl+"/event/",o,null,function(t,n){var o=t.response||t.responseText;if(n&&o){var i=JSON.parse(o);if(i.vid)return g[y].Storage.write("tap_vid",i.vid),s([i.vid]),void("function"==typeof e.callback&&(1==e.options.always_callback?e.callback(null,i):e.callback(i)))}return h("Tracking request failed",e.options,e.callback)})}g[y].Click.q.splice(t,1)}},g[y].Conversion=g[y].Conversion||{},g[y].Conversion.q=g[y].Conversion.q||[],g[y].Conversion.flushQueue=function(){g[y].Conversion.q.reverse();for(var t=g[y].Conversion.q.length-1;t>=0;t--){var e=g[y].Conversion.q[t].data,n=g[y].Conversion.q[t].type,o="undefined"!=typeof g[y].Conversion.q[t].vid?g[y].Conversion.q[t].vid:l();if(!(e.acc&&o||e.options.attribution_id))return h("Non-tracked visitor",e.options,e.callback);var r,a=g[y].baseUrlDepr+"/api/conversions/track/";if("single"==n)r={acc:e.acc,vid:o,tid:e.tid,tam:e.tam,options:e.options,ct:e.ct};else{if("multi"!=n)return h("Missing request type",e.options,e.callback);r={acc:e.acc,vid:o,tid:e.tid,options:e.options,com:e.com}}i(a,r,"POST",function(t,n){if(!n)return h("Conversion denied",e.options,e.callback);var o;try{o=JSON.parse(t.response)}catch(i){return h("Conversion denied",e.options,e.callback)}"function"==typeof e.callback&&(1==e.options.always_callback?e.callback(null,o):e.callback(o,"success"))}),o&&o.length&&g[y].Conversion.q.splice(t,1)}},g[y].create=function(e,n,o){w=e,S=t(S,n||{}),d(S),g[y].Storage.read("tap_vid",{},function(t,e){s(e),c(),"function"==typeof o&&o()})},g[y].detect=function(t,e){t=t||{},this.urlParams=r();var n=this.urlParams[t.asset_param||"tap_a"],o=this.urlParams[t.source_param||"tap_s"];g[y].Click.track(n,o,t,e)},g[y].click=function(t,e,n){var o=t||{};e=e||{};var i=o.tap_a||o.asset_id,r=o.tap_s||o.source_id;"undefined"!=typeof o.referral_code&&(e.referral_code=o.referral_code),g[y].Click.track(i,r,e,n)},g[y].conversion=function(t,e,n,o,i){t=t||null,e="undefined"!=typeof e?e:null,n=n||{};var r=w,a={type:"single",data:{acc:r,tid:t,tam:e,options:n,ct:o,callback:i}};g[y].Conversion.q.push(a),c()},g[y].transactionMulti=function(t,e,n,o){g[y].conversionMulti(t,e,n,o)},g[y].conversionMulti=function(t,e,n,o){e=e||{};var i={type:"multi",data:{acc:w,tid:t,com:n,options:e,callback:o}};g[y].Conversion.q.push(i),c()},g[y].detectClick=function(t){g[y].detect({referral_code_param:null},t)},g[y].transaction=function(t,e,n,o,i){g[y].conversion(t,e,n,o,i)};var O=function(){var t;k.reverse();for(var e=k.length-1;e>=0;e--){var n=k[e][0];"create"===n&&t||(g[y].apply(window,k[e]),k.splice(e,1),"create"===n&&(t=!0))}};O()}}();